from scapy.all import *
import threading

class MyThread(threading.Thread):
    def __init__(self,func,args,name=''):
        threading.Thread.__init__(self)
        self.name=name
        self.func=func
        self.args=args

    def run(self):
        self.func(*self.args)

extra_ctrl = '\x11'
payload = extra_ctrl + '1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'

def stopfilter(x):
    if x[Ether].src == '23.212.52.66':
        return True
    else:
        return False

def send_packet(ether):
    sendp(ether/LLC(dsap=0x0e, ssap=0x0f, ctrl=0x10)/Raw(payload.encode('ascii')))

def main():
    ether = Ether()
    ether.dst = "FF:FF:FF:FF:FF:FF"
    ether.type = 1404
    ether.show()

    threads=[]        #deposit thresds
    sniff(count=0, store=1, stop_filter=stopfilter)

    t = MyThread(send_packet,(ether),send_packet.__name__)
    threads.append(t)

    threads[0].start()

if __name__ == '__main__':
    main()
